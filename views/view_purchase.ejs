<%- include('header') %>
    <!-- partial:partials/_navbar -->
    
    <%- include('navbar') %>
    
    
    
    <!-- partial -->
    <div class="container-fluid page-body-wrapper">
      <!-- partial:partials/_sidebar -->
      <% if(role=="Admin") { %>
        <%- include('Admin_sidebar') %>
        <% } else { %>
          <%- include('sidebar') %>
          <% } %>
      <!-- partial -->
      <div class="main-panel">
        <div class="content-wrapper">
          <div class="row">
            <div class="col-md-12 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <h4 class="card-title">View Purchase Details</h4>
                  <p class="card-description">
                    <% if(message.length > 0) { %>
                      <%= message %>
          <% } %>
                  </p>
                  <form class="forms" method="POST" action="view_purchase">

                    <div class="form-group row">
                        <div class="col-md-6 row">
                            <label for="purchaseId" class="col-sm-3 col-form-label">Purchase Id:</label>
                            <div class="col-sm-9">
                              <input type="text" name ="purchaseId" maxlength="10"  class="form-control" id="purchaseId" placeholder="purchase id">
                            </div>  
                          </div>
                          <div class="col-md-6">
                              <button type="submit" id ="Submit" class=" col-md-6 btn btn-primary mr-2">Submit</button>
                          </div>
                      <div class="col-md-6 row">
                        <label for="date" class="col-sm-3 col-form-label">Date:</label>
                        <div class="col-sm-9">
                          <label type="date" name="date" class="form-control" id="date" placeholder="Date of Registration">
                            <% if(purchase !== null) { %>
                                <%= purchase.PurchaseDate %>
                    <% } %>
                        </label>
                        </div>
                      </div>
                      <div class="col-md-6 row">
                        <label for="supplierId" class="col-sm-3 col-form-label">Supplier Id</label>
                        <div class="col-sm-9">
                            <div class="form-group">
                          <label class="form-control"  name="supplierId" id="supplierId">
                            <% if(purchase !== null) { %>
                                <%= purchase.SupplierId %>
                    <% } %>
                          </label>
                              </div>
                      </div>
                      </div>
                      <div class="col-md-6 row">
                        <label for="invoiceNo" class="col-sm-3 col-form-label">Invoice No</label>
                        <div class="col-sm-9">
                          <label type="text"  maxlength="10" name="invoiceNo" class="form-control" id="invoiceNo" placeholder="Invoice Number">
                            <% if(purchase !== null) { %>
                                <%= purchase.InvoiceNo %>
                    <% } %>
                        </label>
                        </div>
                      </div>
                      <!--
                      <div class="col-md-6 row">
                        <label for="item" class="col-sm-3 col-form-label">Purchase Item</label>
                        <div class="col-sm-9">
                            <div class="form-group">
                          <label name="item" class="form-control" id="item">
                          
                            </lable>
                              </div>
                      </div>
                      </div>
                      <div class="col-md-6 row">
                        <label for="itemCost" class="col-sm-3 col-form-label">Item Cost</label>
                        <div class="col-sm-9">
                            <div class="form-group">
                                <div class="input-group">
                                  <div class="input-group-prepend">
                                    <span class="input-group-text bg-primary text-white">$</span>
                                  </div>
                                  <label type="number" name="itemCost" id="itemCost" class="form-control" aria-label="itemCost">
                                  </label>
                                    <div class="input-group-append">
                                    <span class="input-group-text">.00</span>
                                  </div>
                                </div>
                              </div>
                      </div>
                      </div>
                      <div class="col-md-6 row">
                        <label for="Qty" class="col-sm-3 col-form-label">Quantity</label>
                        <div class="col-sm-9">
                            <div class="form-group">
                                <div class="input-group">
                                 
                                  <input name="qty" type="number" id="qty" class="form-control" aria-label="Quantity">
                                  <div class="input-group-append">
                                    <span class="input-group-text">units</span>
                                  </div>
                                </div>
                              </div>
                      </div>
                      </div>
                      <div class="col-md-6 row">
                        <label for="QtyXCost" class="col-sm-3 col-form-label">Qty * Cost</label>
                        <div class="col-sm-9">
                            <div class="form-group">
                                <div class="input-group">
                                   <div class="input-group-append">
                                    <span class="input-group-text">$</span>
                                  </div>
                                  <input type="number" readonly name="QtyXCost" id="QtyXCost" class="form-control" aria-label="QtyXCost">
                                
                                </div>
                              </div>
                      </div>
                      </div>
                      <div class="col-md-6 row">
                        <label for="discount" class="col-sm-3 col-form-label">Discount</label>
                        <div class="col-sm-9">
                            <div class="form-group">
                                <div class="input-group">
                                 
                                  <input type="number" name="discount" id="discount" class="form-control" aria-label="discount">
                                  <div class="input-group-append">
                                    <span class="input-group-text">%</span>
                                  </div>
                                </div>
                              </div>
                      </div>
                      </div>
                      <div class="col-md-6 row">
                        <label for="vat" class="col-sm-3 col-form-label">VAT</label>
                        <div class="col-sm-9">
                            <div class="form-group">
                                <div class="input-group">
                                 
                                  <input type="number" name="vat" id="vat" class="form-control" aria-label="vat">
                                  <div class="input-group-append">
                                    <span class="input-group-text">%</span>
                                  </div>
                                </div>
                              </div>
                      </div>
                      </div>
                      <div class="col-md-6">
                       
                    </div>
                        <button type="button"  id="addItem" class="col-sm-5  btn btn-sm btn-primary mr-2">Add Item</button>
                        <button  type="button" id="removeItem" class="col-sm-5 btn-sm  btn btn-dribbble">Remove</button>
                         
                       
                   -->
                    
                     
                       
                        <div class="form-group col-md-12">
                          <div class="row">
                            <div class="col-md-12 stretch-card">
                              <div class="card">
                                <div class="card-body">
                                  <p class="card-title">Purchase Item Details</p>
                                  <div class="table-responsive">
                                    <table border="0" cellspacing="0" cellpadding="0" class="table table-dark table-hover">
                                      <% 
                                      var formatter = new Intl.NumberFormat(undefined, {
                                        style: 'currency',
                                        currency: 'NGN',
                                      });
                                      
                                      
                                      %>
                                        <thead>
                                            <tr>
                                             
                                                <th>#</th>
                                                <th class="text-left">Prod Id</th>
                                                <th class="text-left">Product Name</th>
                                                <th class="text-right">Unit Cost</th>
                                                <th class="text-right">Qty</th>
                                                <th class="text-right">Total Cost</th>
                                                <th class="text-right">% VAT</th>
                                                <th class="text-right">Total VAT</th>
                                                <th class="text-right">% Discount</th>
                                                <th class="text-right">Total Discount</th>
                                              
                                            </tr>
                                        </thead>
                                        <tbody>
                                          <% if (purchase !== null) { %>
                                         <% if(purchase.PurchaseItemsDetails !== undefined) { 
                                            item = purchase.PurchaseItemsDetails.split(';') 
                                            for(i =0; i < (item.length)-1; i++){
                                               itemize = item[i].split(','); %>
                                              <tr>
                                                <td class="unit sn"> <%= i+1 %></td>
                                       
                                                <td class="qty id"> <%= itemize[0] %></td>
                                                <td class="unit desc"><%= itemize[1] %></td>
                                                <td class="qty cost"> <%= formatter.format(itemize[2]) %></td>
                                                <td class="unit qty"> <%= itemize[5] %></td>
                                                <td class="total tcost"> <%= formatter.format(itemize[6]) %></td>
                                                <td class="qty vat" > <%= itemize[3] %></td>
                                                <td class="total tVat"> <%= formatter.format(itemize[8]) %></td>
                                                <td class="unit dis"><%= itemize[4] %></td>                               
                                                <td class="total tdisc"><%= formatter.format(itemize[7]) %></td>
                                               
                                                
                                              </tr>
                                <% } }%> 
                                <% } %>
                                          </tbody>  </table>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                      </div>
 <div class="col-md-12 row">
  <div class="col-md-4 row">
    <label for="totalPurchase" class="col-sm-4 col-form-label">Total Purchase</label>
    <div class="col-sm-8">
        <div class="form-group">
          <div class="input-group">
            <div class="input-group-prepend">
              <span class="input-group-text bg-primary text-white">$</span>
            </div>
            <label type="number" name="totalPurchase" readonly id="totalPurchase" class="form-control" aria-label="totalPurchase">
                <% if(purchase !== null) { %>
                    <%= purchase.PurchaseAmount %>
        <% } %>
            </label>
          </div>
          </div>
  </div>
  </div>
  <div class="col-md-4 row">
    <label for="totalVAT" class="col-sm-3 col-form-label">Total VAT</label>
    <div class="col-sm-9">
        <div class="form-group">
          <div class="input-group">
            <div class="input-group-prepend">
              <span class="input-group-text bg-primary text-white">$</span>
            </div>
            <label  type="number" name="totalVAT" readonly id="totalVAT" class="form-control" aria-label="totalVAT">
                <% if(purchase !== null) { %>
                    <%= purchase.TotalVAT %>
        <% } %>
            </label>
          </div>
          </div>
  </div>
  </div>
  <div class="col-md-4 row">
    <label for="totalDiscount" class="col-sm-3 col-form-label">Total Discount</label>
    <div class="col-sm-9">
        <div class="form-group">
          <div class="input-group">
            <div class="input-group-prepend">
              <span class="input-group-text bg-primary text-white">$</span>
            </div>
            <label type="number" name="totalDiscount" readonly id="totalDiscount" class="form-control" aria-label="totalDiscount">
                <% if(purchase !== null) { %>
                    <%= purchase.PurchaseDiscount %>
        <% } %>
            </label>
          </div>
          </div>
  </div>
  </div>
  <div class="col-md-4 row">
    <label for="amountDue" class="col-sm-4 col-form-label">Amount Due</label>
    <div class="col-sm-8">
        <div class="form-group">
            <div class="input-group">
              <div class="input-group-prepend">
                <span class="input-group-text bg-primary text-white">$</span>
              </div>
              <label type="number" name="amountDue" readonly id="amountDue" class="form-control" aria-label="amountDue">
                <% if(purchase !== null) { %>
                    <%= purchase.AmountDue %>
        <% } %> 
            </label>
            </div>
          </div>
  </div>
  </div>
  <div class="col-sm-5"></div>
 <!--<button type="submit" id ="Submit" class="col-sm-5 btn btn-primary mr-2">Submit</button>
                    <button type="reset" id="clear" class="col-sm-5 btn btn-dark  mr-2">Cancel</button>
  --> 
                    
                     
                    
                     

                 

                    
                  </form>
                </div>
            </div>
            </div>
           
        <!-- content-wrapper ends -->
        <!-- partial:partials/_footer -->
       <%- include('footer.ejs')%>
        <!-- partial -->
      </div>
      <!-- main-panel ends -->
    </div>
    <!-- page-body-wrapper ends -->
  </div>
  <!-- container-scroller -->
  <!-- plugins:js -->
  <script src="vendors/base/vendor.bundle.base.js"></script>
  <!-- endinject -->
  <!-- Plugin js for this page-->
  <!-- End plugin js for this page-->
  <!-- inject:js -->
  <script src="js/off-canvas.js"></script>
  <script src="js/hoverable-collapse.js"></script>
  <script src="js/template.js"></script>
  <script src = 'js/purchase.js'> </script>
  <!-- endinject -->
  <!-- Custom js for this page-->
  <!-- End custom js for this page-->
</body>

</html>